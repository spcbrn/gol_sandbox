(()=>{function a({x:t,y:u,living:v,bio_mode:w,game:z}){this.game=z,this.coordinates=[t,u],this.x=t,this.y=u,this.key=`${t}.${u}`,this.nCoords=[],this.living=v,this.bioMode=w,this.bioMode?(()=>{this.dna=[],this.art=[],this.newArt=[]})():this.livingNeighbors=0,this.subscribedToRegister=!1,this._initializeCell()}let b=0;class e{constructor({width:t,height:u,render:v,use_raf:w,bio_mode:z,seed_frame:A,random:B}){this.width=t||50,this.height=u||50,this.grid=null,this.gridBinary=null,this.useRandomGrid=B||!1,A instanceof Array&&A[0]instanceof Array&&"number"==typeof A[0][0]&&(()=>{this.gridBinary=A,this.height=A.length,this.width=A[0].length})(),this.bioMode=z||!1,this.dutyCycle=[],this.frameRegister=[],this.interval=null,this._to=null,this.framesElapsed=0,this.useRequestAnimationFrame=w||!0,this.render=C=>v(this.gridBinary,this.framesElapsed,C),this._populateGameGrid()}}e.prototype._initializeGame=function(t,u=0){this.interval=t||200,this.useRequestAnimationFrame?window.requestAnimationFrame(this.render):this.render(),this._to=this._runGameLoop(u)},e.prototype._runGameLoop=function(t){return t&&this.framesElapsed>=t?clearTimeout(this._to):setTimeout(()=>{this._dispatchRunDutyCycle(),this._dispatchApplyRulesToRegister(),this.useRequestAnimationFrame?window.requestAnimationFrame(this.render):this.render(),this.framesElapsed++,this._to=this._runGameLoop(t)},this.interval)},e.prototype._populateGameGrid=function(){this.gridBinary=this.gridBinary?this.gridBinary:this._generateNewBinaryGrid({width:this.width,height:this.height,random:this.useRandomGrid}),this.grid=this.gridBinary.map((t,u)=>t.map((v,w)=>new a({x:w,y:u,living:v,bio_mode:this.bioMode,game:this})))},e.prototype._generateNewBinaryGrid=function({width:t,height:u,random:v}){const w=Array(u).fill(Array(t).fill(0));return v?this._randomizeGameGrid(w):w},e.prototype._randomizeGameGrid=t=>{for(let u in t)t[u]=t[u].map(()=>0.936<Math.random()?1:0);return t},e.prototype._subscribeCellToDutyCycle=function(t){this.dutyCycle.push(t)},e.prototype._dispatchRunDutyCycle=function(){this.dutyCycle=this.dutyCycle.filter(t=>!("function"!=typeof t)&&(()=>{return t(),!1})())},e.prototype._subscribeCellToFrameRegister=function(t){this.frameRegister.push(t)},e.prototype._dispatchApplyRulesToRegister=function(){this.frameRegister=this.frameRegister.filter(t=>!("function"!=typeof t)&&(()=>{return t((u,v)=>{this.gridBinary[u[1]][u[0]]=v}),!1})())},a.prototype._living=function(){return 1===this.living},a.prototype._initializeCell=function(){this._living()&&(()=>{this.game._subscribeCellToDutyCycle(()=>this._distributeLifeForce()),this.bioMode&&(this.dna=[this._produceDNA(),this._produceDNA(),this._produceDNA()])})()},a.prototype._getNeighborCoordinates=function(){return this.nModifiers.map(t=>{const u=this.x+t[0],v=this.y+t[1];return 0<=u&&u<this.game.width&&0<=v&&v<this.game.height?[u,v]:null})},a.prototype.nModifiers=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]],a.prototype._produceDNA=function(){return String.fromCharCode(Math.ceil(25*Math.random()+65))+String.fromCharCode(Math.ceil(25*Math.random()+65))},a.prototype._produceArt=function(){return String.fromCharCode(Math.ceil(103*Math.random()+152))+String.fromCharCode(Math.ceil(103*Math.random()+152))+String.fromCharCode(Math.ceil(103*Math.random()+152))},a.prototype._distributeLifeForce=function(){this.nCoords.length||(this.nCoords=this._getNeighborCoordinates());let t=0;return this.nCoords.forEach(u=>{if(null!==u){const v=this.game.grid[u[1]][u[0]];v._living()?(()=>{v._absorbLifeForce(this.bioMode&&this._produceArt()),t++})():v._absorbLifeForce(this.bioMode&&this._produceDNA())}}),t||(this.bioMode?this._absorbLifeForce(this._produceArt()):(()=>{this.game._subscribeCellToFrameRegister(u=>this._applyRules(u)),this.subscribedToRegister=!0})()),!1},a.prototype._absorbLifeForce=function(t){this.living?this.bioMode?this.newArt.push(t):this.livingNeighbors++:this.bioMode?this.dna.push(t):this.livingNeighbors++,this.subscribedToRegister||(()=>{this.game._subscribeCellToFrameRegister(u=>this._applyRules(u)),this.subscribedToRegister=!0})()},a.prototype._applyRules=function(t){const u=this.bioMode?this.living?this.newArt.length:this.dna.length:this.livingNeighbors,v=1===this.living?1>=u||4<=u?0:1:3===u?1:0;return v&&(()=>{this.game._subscribeCellToDutyCycle(()=>this._distributeLifeForce()),this.living&&this.bioMode&&this.art.concat(this.newArt)})(),!v&&this.bioMode&&(()=>{this.dna=[]})(),this.living=v,this.subscribedToRegister=!1,this.bioMode?this.newArt=[]:this.livingNeighbors=0,t(this.coordinates,v)};const g=document.createElement("div");g.setAttribute("id","dom_root"),g.setAttribute("style",`width:0px;height:0px;position:relative;z-index:1111;`);const h=document.createElement("canvas");h.setAttribute("id","c_root"),h.setAttribute("width","512px"),h.setAttribute("height","512px"),h.setAttribute("style",`position:absolute;left:calc(50vw - 256px);top:calc(50vh - 256px);background:#F5F5F5;`),document.body.prepend(g),g.appendChild(h);const i=document.getElementById("c_root"),j=i.getContext("2d");j.font="24px serif";const k=96,l=96,m=i.width/k,o=i.height/l,q=t=>t.forEach((u,v)=>u.forEach((w,z)=>{j.fillStyle=1===w?"#222222":"#FFFFFF",j.fillRect(z*m,v*o,m-1,o-1)})),r=t=>{j.fillStyle="#000000",j.fillText(`generations: ${t}   fps: ${2<=b?Math.floor(10*t/b):"--"}`,12,i.height-12)},s=new e({width:k,height:l,render:(t,u)=>{j.clearRect(0,0,i.width,i.height),q(t),r(u)},useRAF:!0,random:!0});s._initializeGame(93),(()=>window.setInterval(()=>b++,100))()})();